"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4503],{30667:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>a});var r=o(74848),t=o(28453);const i={},s="Requirements",c={id:"container/components/k8s-cluster-api-provider/doc/requirements",title:"Requirements",description:"Cluster API requires an existing Kubernetes cluster to operate. In our setup, we",source:"@site/docs/03-container/components/k8s-cluster-api-provider/doc/requirements.md",sourceDirName:"03-container/components/k8s-cluster-api-provider/doc",slug:"/container/components/k8s-cluster-api-provider/doc/requirements",permalink:"/docs/container/components/k8s-cluster-api-provider/doc/requirements",draft:!1,unlisted:!1,editUrl:"https://github.com/SovereignCloudStack/docs/tree/main/docs/03-container/components/k8s-cluster-api-provider/doc/requirements.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Overview",permalink:"/docs/container/components/k8s-cluster-api-provider/doc/overview"},next:{title:"Quickstart",permalink:"/docs/container/components/k8s-cluster-api-provider/doc/quickstart"}},l={},a=[{value:"Environments",id:"environments",level:2},{value:"Plusserver community environment",id:"plusserver-community-environment",level:3},{value:"Wavestack environment",id:"wavestack-environment",level:3},{value:"Custom environment",id:"custom-environment",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"requirements",children:"Requirements"}),"\n",(0,r.jsxs)(n.p,{children:["Cluster API requires an existing Kubernetes cluster to operate. In our setup, we\nutilize ",(0,r.jsx)(n.a,{href:"https://kind.sigs.k8s.io/",children:"kind"})," a tool for running Kubernetes clusters using Docker containers, to create\nthe initial management Kubernetes cluster in a single docker container. The OpenStack instance serves as the CAPI\nmanagement server or management cluster, responsible for overseeing the\nmanagement and operation of the created kubernetes clusters."]}),"\n",(0,r.jsx)(n.p,{children:"The provisioning of the CAPI management server is done on a deployment host, possibly a tiny jumphost style VM, or some\nLinux/MacOS/WSL laptop."}),"\n",(0,r.jsx)(n.p,{children:"Requirements for the deployment host:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["You need to have installed:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://opentofu.org/docs/intro/install/",children:"OpenTofu"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"yq"})," (python3-yq or yq snap)"]}),"\n",(0,r.jsx)(n.li,{children:"GNU make"}),"\n",(0,r.jsxs)(n.li,{children:["openstack (python3-openstackclient) and plugin for octavia (python3-octaviaclient) Via pip or your distribution.\n",(0,r.jsx)(n.em,{children:"Needed only in case you want to clean the management server or interact with openstack directly."})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["You must have credentials to access the cloud. OpenTofu will look for ",(0,r.jsx)(n.code,{children:"clouds.yaml"})," and optionally ",(0,r.jsx)(n.code,{children:"secure.yaml"})," in\nthe current working directory (",(0,r.jsx)(n.code,{children:"terraform"}),"), in ",(0,r.jsx)(n.code,{children:"~/.config/openstack/"})," or ",(0,r.jsx)(n.code,{children:"/etc/openstack"})," (in this order), just like\nthe ",(0,r.jsx)(n.a,{href:"https://docs.openstack.org/python-openstackclient/latest/configuration/index.html#clouds-yaml",children:"openstack client"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"The API endpoints of the OpenStack cloud should have a certificate signed by a trusted CA. (Self-signed or custom CAs\nneed significant manual work -- this will be improved after R4.)"}),"\n",(0,r.jsxs)(n.li,{children:["An Environment file for the cloud you want to use. See ",(0,r.jsx)(n.a,{href:"#environments",children:"Environments"})," below for more details."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"environments",children:"Environments"}),"\n",(0,r.jsxs)(n.p,{children:["To use a specific environment, you have to set the ",(0,r.jsx)(n.code,{children:"ENVIRONMENT"})," variable (",(0,r.jsx)(n.code,{children:"export ENVIRONMENT=<yourcloud>"}),") or pass it\nto the ",(0,r.jsx)(n.code,{children:"make"})," command by using ",(0,r.jsx)(n.code,{children:"make <command> ENVIRONMENT=<yourcloud>"}),".\nYou can also do the same by utilizing the ",(0,r.jsx)(n.code,{children:"OS_CLOUD"})," (openstack native) variable.\nThe name of the environment is derived from the name of the file ",(0,r.jsx)(n.code,{children:"environments/environment-<yourcloud>.tfvars"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["The name of the environment specified either via ",(0,r.jsx)(n.code,{children:"ENVIRONMENT"})," or ",(0,r.jsx)(n.code,{children:"OS_CLOUD"})," has to be equal the name of the\ncloud (",(0,r.jsx)(n.code,{children:"cloud_provider"}),") as specified in your ",(0,r.jsx)(n.code,{children:"clouds.yaml"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["In case you use ",(0,r.jsx)(n.a,{href:"#plusserver-community-environment",children:"plusserver community environment"}),"\nor ",(0,r.jsx)(n.a,{href:"#wavestack-environment",children:"wavestack environment"})," you can use the default environment file for\nthose directly or base your configuration on it. In case you need custom configuration\nsee ",(0,r.jsx)(n.a,{href:"#custom-environment",children:"Custom environment"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["More information about the configuration options can be found in the ",(0,r.jsx)(n.a,{href:"/docs/container/components/k8s-cluster-api-provider/doc/configuration",children:"configuration documentation"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"plusserver-community-environment",children:"Plusserver community environment"}),"\n",(0,r.jsxs)(n.p,{children:["Using it directly:\n",(0,r.jsx)(n.code,{children:"export ENVIRONMENT=gx-scs"})]}),"\n",(0,r.jsxs)(n.p,{children:["or insert inside of Makefile:\n",(0,r.jsx)(n.code,{children:"ENVIRONMENT=gx-scs"})]}),"\n",(0,r.jsxs)(n.p,{children:["File: ",(0,r.jsx)(n.code,{children:"environments/environment-gx-scs.tfvars"})]}),"\n",(0,r.jsxs)(n.p,{children:["The name of the cloud has to be ",(0,r.jsx)(n.code,{children:"gx-scs"})," in the ",(0,r.jsx)(n.code,{children:"cloud.yaml"})," file, otherwise you will need\nto change the ",(0,r.jsx)(n.code,{children:"cloud_provider"})," variable inside of ",(0,r.jsx)(n.code,{children:"terraform/environments/environment-gx-scs.tfvars"})," file."]}),"\n",(0,r.jsx)(n.h3,{id:"wavestack-environment",children:"Wavestack environment"}),"\n",(0,r.jsxs)(n.p,{children:["Using it directly:\n",(0,r.jsx)(n.code,{children:"export ENVIRONMENT=gx-wavestack"})]}),"\n",(0,r.jsxs)(n.p,{children:["or insert inside of Makefile:\n",(0,r.jsx)(n.code,{children:"ENVIRONMENT=gx-wavestack"})]}),"\n",(0,r.jsxs)(n.p,{children:["File: ",(0,r.jsx)(n.code,{children:"environments/environment-gx-wavestack.tfvars"})]}),"\n",(0,r.jsxs)(n.p,{children:["The name of the cloud has to be ",(0,r.jsx)(n.code,{children:"gx-wavestack"})," in the ",(0,r.jsx)(n.code,{children:"cloud.yaml"})," file, otherwise you will need\nto change the ",(0,r.jsx)(n.code,{children:"cloud_provider"})," variable inside of ",(0,r.jsx)(n.code,{children:"terraform/environments/environment-gx-scs.tfvars"})," file."]}),"\n",(0,r.jsx)(n.h3,{id:"custom-environment",children:"Custom environment"}),"\n",(0,r.jsxs)(n.p,{children:["You can create your own environment file from the sample file ",(0,r.jsx)(n.code,{children:"environments/environment-default.tfvars"})," and provide the\nnecessary information like machine flavor or machine image. You can comment out all lines where the defaults match your\nneeds."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>c});var r=o(96540);const t={},i=r.createContext(t);function s(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);